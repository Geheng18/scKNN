% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/KNN2LMM.R
\name{KNN2LMM}
\alias{KNN2LMM}
\title{Convert Single-Cell Data to Kernel Variance Components with Gene Regions}
\usage{
KNN2LMM(
  counts.mat,
  annotation,
  gene.regions = NULL,
  input.kernel = NULL,
  method = "KNN"
)
}
\arguments{
\item{counts.mat}{A numeric matrix of gene expression counts with genes in rows
and cells in columns. Row names should be gene identifiers.}

\item{annotation}{A data frame with cell-level annotations containing at least
two columns:
\describe{
\item{cell.type}{Factor indicating the cell type of each cell}
\item{donor}{Factor indicating the donor/individual of each cell}
}
The number of rows must equal the number of columns in \code{counts.mat}.}

\item{gene.regions}{A list where each element is a character vector of gene names
defining a gene region. If NULL (default), all genes are treated as one region.
Example: list(c("Gene1", "Gene2"), c("Gene3", "Gene4", "Gene5"))}

\item{input.kernel}{Character vector specifying kernel types. If gene.regions is
provided, length should equal length(gene.regions) * n_celltypes. Otherwise,
length should equal n_celltypes. If NULL, uses "product" kernel for all.}

\item{method}{Character string specifying the model type:
\describe{
\item{"LMM"}{Linear mixed model with only first-order kernels}
\item{"KNN"}{Kernel neural network with first-order, second-order, and
interaction terms (default)}
}}
}
\value{
A list of variance component matrices. The order of components (after
the identity matrix) follows: celltype1_region1, celltype1_region2, ...,
celltype2_region1, celltype2_region2, etc.
}
\description{
Transforms single-cell RNA-seq data into kernel-based variance components for
linear mixed models. This function performs pseudobulk aggregation by cell type
and gene region, then constructs kernel matrices that can be used as variance
components in downstream association analyses.
}
