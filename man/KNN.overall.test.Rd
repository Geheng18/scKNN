% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/KNN_test.R
\name{KNN.overall.test}
\alias{KNN.overall.test}
\title{Overall Hypothesis Test for Variance Components using KNN}
\usage{
KNN.overall.test(
  pheno.donor,
  counts.mat,
  annotation,
  test.ind,
  gene.regions = NULL,
  input.kernel = NULL,
  MINQUE.type = "MINQUE0",
  method = "KNN",
  lambda = 0,
  weight = NULL,
  design.mat = NULL,
  constrain = FALSE,
  variance.component.list = NULL
)
}
\arguments{
\item{pheno.donor}{Numeric vector of phenotype values for each donor}

\item{counts.mat}{Numeric matrix of gene expression counts (genes x cells)}

\item{annotation}{Data frame with cell-level annotations containing cell.type
and donor columns}

\item{test.ind}{Integer vector of indices specifying which variance components to test}

\item{gene.regions}{A list where each element is a character vector of gene names}

\item{input.kernel}{Character vector specifying kernel types for each cell type}

\item{MINQUE.type}{Character string, either "MINQUE0" or "MINQUE1"}

\item{method}{Character string, either "LMM" or "KNN" (default)}

\item{lambda}{Numeric regularization parameter (default = 0)}

\item{weight}{Optional numeric vector of initial weights for variance components}

\item{design.mat}{Optional design matrix for fixed effects}

\item{constrain}{Logical, whether to constrain variance components to be non-negative}

\item{variance.component.list}{Optional pre-computed variance component matrices}
}
\value{
A list containing:
\describe{
\item{pvalue}{P-value from the mixture of chi-square test}
}
}
\description{
Performs an overall test for multiple variance components in a Kernel Neural Network
model using a mixture of chi-square distributions. Tests the null hypothesis that
specified variance components are zero.
}
\details{
The test statistic follows a mixture of chi-square distributions under the null
hypothesis. The Davies method is used to compute accurate p-values. This test
is particularly useful for testing the joint significance of multiple cell types
or kernel components.
}
\examples{
\dontrun{
# Test if cell types 2 and 3 contribute to phenotypic variance
test_result <- KNN.overall.test(pheno.donor, counts.mat, annotation,
                                 test.ind = c(2, 3))
print(test_result$pvalue)
}

}
\references{
Davies, R. B. (1980). "Algorithm AS 155: The distribution of a linear
combination of chi-squared random variables." Applied Statistics, 323-333.
}
