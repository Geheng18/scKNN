% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict_MINQUE.R
\name{predict.MINQUE}
\alias{predict.MINQUE}
\title{Predict Method for MINQUE with Single-Cell Data}
\usage{
\method{predict}{MINQUE}(
  y,
  counts.mat,
  annotation,
  gene.regions = NULL,
  input.kernel = NULL,
  theta,
  method = "KNN",
  beta = NULL,
  design.mat.train = NULL,
  design.mat.test = NULL,
  variance.component.list = NULL,
  train.donors,
  test.donors
)
}
\arguments{
\item{y}{Numeric vector of training phenotypes (length = number of training donors)}

\item{counts.mat}{Combined count matrix for both training and test data (genes x cells)}

\item{annotation}{Combined annotation data frame for both training and test cells}

\item{gene.regions}{A list where each element is a character vector of gene names}

\item{input.kernel}{Character vector specifying kernel types for each cell type}

\item{theta}{Numeric vector of estimated variance components from MINQUE}

\item{method}{Character string, either "LMM" or "KNN" (must match training)}

\item{beta}{Numeric vector of fixed effects coefficients (if applicable)}

\item{design.mat.train}{Design matrix for training donors}

\item{design.mat.test}{Design matrix for test donors}

\item{variance.component.list}{Optional pre-computed variance components}

\item{train.donors}{Character vector of training donor IDs}

\item{test.donors}{Character vector of test donor IDs}
}
\value{
Numeric vector of predicted phenotype values for test donors
}
\description{
Predicts phenotype values for new donors using a fitted MINQUE model. This function
computes Best Linear Unbiased Predictions (BLUPs) based on the estimated variance
components and observed phenotypes.
}
\details{
The prediction uses the mixed model equation:
\deqn{\hat{y}_{test} = X_{test}\hat{\beta} + \Sigma_{test,train}\Sigma_{train}^{-1}(y_{train} - X_{train}\hat{\beta})}

where \eqn{\Sigma} is the covariance matrix constructed from variance components.
}
\examples{
\dontrun{
# After fitting MINQUE model
fit <- MINQUE(pheno.train, counts.train, annotation.train)

# Predict for new donors
pred <- predict.MINQUE(pheno.train, counts.combined, annotation.combined,
                       input.kernel = NULL, theta = fit$theta,
                       train.donors = train.ids, test.donors = test.ids)
}

}
