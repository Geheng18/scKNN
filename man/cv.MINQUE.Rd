% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cv_MINQUE.R
\name{cv.MINQUE}
\alias{cv.MINQUE}
\title{Cross-Validation for MINQUE Lambda Selection (Updated)}
\usage{
cv.MINQUE(
  pheno.donor,
  counts.mat,
  annotation,
  gene.regions = NULL,
  lambda.seq = c(0, 0.01, 0.1, 1, 10, 100),
  n.folds = 5,
  input.kernel = NULL,
  MINQUE.type = "MINQUE0",
  method = "KNN",
  design.mat = NULL,
  criteria = c("MSE", "correlation", "R2"),
  verbose = TRUE
)
}
\arguments{
\item{pheno.donor}{Numeric vector of phenotype values for each donor. Length
must equal the number of unique donors in \code{annotation}.}

\item{counts.mat}{Numeric matrix of gene expression counts with genes in rows
and cells in columns. Row names should be gene identifiers.}

\item{annotation}{Data frame with cell-level annotations containing:
\describe{
\item{cell.type}{Factor indicating the cell type of each cell}
\item{donor}{Factor indicating the donor/individual of each cell}
}}

\item{gene.regions}{A list where each element is a character vector of gene names
defining a gene region. If NULL (default), all genes are treated as one region.
Example: list(c("Gene1", "Gene2"), c("Gene3", "Gene4", "Gene5"))}

\item{lambda.seq}{Numeric vector of lambda values to test}

\item{n.folds}{Integer number of cross-validation folds (default = 5)}

\item{input.kernel}{Character vector specifying kernel types for each cell type.
Options include "product", "gaussian", "polynomial", etc. If NULL (default),
uses "product" kernel for all cell types.}

\item{MINQUE.type}{Character string specifying the MINQUE estimator type:
\describe{
\item{"MINQUE0"}{Assumes all variance components are equal (default)}
\item{"MINQUE1"}{Uses initial weights for variance components}
}}

\item{method}{Character string specifying the variance component model:
\describe{
\item{"LMM"}{Linear mixed model with first-order kernels only}
\item{"KNN"}{Kernel neural network with first and second-order terms (default)}
}}

\item{design.mat}{Optional design matrix for fixed effects (covariates). Each
column represents a covariate, rows correspond to donors.}

\item{criteria}{Selection criterion: "MSE", "correlation", or "R2"}

\item{verbose}{Logical, whether to print progress messages}
}
\value{
A list of class "cv.MINQUE" containing cross-validation results
}
\description{
Performs k-fold cross-validation to select the optimal regularization parameter
(lambda) for MINQUE variance component estimation in single-cell data analysis.
}
